(this["webpackJsonpreact-ts"]=this["webpackJsonpreact-ts"]||[]).push([[0],{27:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t),n.d(t,"app",(function(){return E}));var a=n(10),r=n(3),c=n.n(r),i=n(20),s=n.n(i),o=(n(27),n(21)),u=n(4),d=n.n(u),l=n(7),f=n(5),j=(n(29),n(30),n(1));var b=function(e){var t=Object(r.useState)([]),n=Object(f.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)(0),s=Object(f.a)(i,2),o=s[0],u=s[1];return Object(r.useEffect)((function(){if(e.characters&&!e.characters.includes("empty")){var t=e.characters,n=[];t.forEach((function(e){n.push(Object(j.jsxs)("figure",{className:"character-preview",children:[Object(j.jsx)("img",{src:"assets/characters/"+e+".png",alt:e}),Object(j.jsx)("figcaption",{children:e})]},e+Date.now()))})),c(n)}}),[JSON.stringify(e.characters)]),Object(r.useEffect)((function(){!e.gameEnded&&e.gameStarted?setTimeout((function(){u((function(e){return e+1}))}),1e3):u(-1),e.gameEnded&&c([])}),[e.gameStarted,e.gameEnded,o]),Object(r.useEffect)((function(){var t=e.foundCharacter,n=a.findIndex((function(e){return e.key?e.key.toString().includes(t):-1}));n>-1&&(a[n]=Object(j.jsxs)("figure",{className:"character-preview found",children:[Object(j.jsx)("img",{src:"assets/characters/"+t+".png",alt:t}),Object(j.jsx)("figcaption",{children:t})]},t+Date.now()))}),[e.foundCharacter]),Object(j.jsxs)("header",{children:[Object(j.jsxs)("nav",{children:[Object(j.jsx)("div",{children:Object(j.jsx)("img",{title:"Retry",src:"assets/retry.png",alt:"Retry",onClick:function(){document.location.reload()}})}),Object(j.jsx)("div",{children:Object(j.jsx)("img",{title:"Leaderboard",src:"assets/leaderboard.png",alt:"show leaderboard",onClick:e.showLeaderBoard})})]}),Object(j.jsx)("div",{id:"timer",children:o>-1?k(o):""}),Object(j.jsx)("div",{id:"characters",children:a})]})},p=n(15);n(32),n(33);var h=function(e){var t=Object(p.a)(e.choices),n=[];return t.forEach((function(e){return n.push(Object(j.jsx)("div",{className:"choice",children:e},e))})),Object(j.jsx)("div",{onClick:function(t){t.target.className.includes("choice")&&e.onClick(t.target.textContent,e.x,e.y)},style:{top:e.y+"px",left:e.x+"px"},id:"Dropdown",children:n})},O=(n(19),!!localStorage.getItem("playedBefore"));localStorage.setItem("playedBefore","yes");var x=function(e){var t=a.a.firestore().collection("building").doc("characters"),n=Object(r.useState)(!1),c=Object(f.a)(n,2),i=c[0],s=c[1],o=Object(r.useState)(e.characters),u=Object(f.a)(o,2),b=u[0],x=u[1],m=Object(r.useState)(Object(j.jsx)(j.Fragment,{})),v=Object(f.a)(m,2),g=v[0],y=v[1],w=Object(r.useState)(Object(j.jsx)(j.Fragment,{})),k=Object(f.a)(w,2),S=k[0],C=k[1];function E(e,t){var n=document.querySelector("#game-image");if(n){var a=[n.clientWidth,n.clientHeight],r=a[0],c=a[1];return[Math.round(1e3*(e-n.offsetLeft)/r),Math.round(1e3*(t-n.offsetTop)/c)]}return console.error("no game image"),[]}function I(e,t,n){return L.apply(this,arguments)}function L(){return(L=Object(l.a)(d.a.mark((function t(n,a,r){var c,i,s,o,u;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(B("Checking...","#ffc802",-1),c=E(a,r),i=Object(f.a)(c,2),s=i[0],o=i[1],!s||!o){t.next=24;break}return C(Object(j.jsx)(j.Fragment,{})),t.prev=4,t.next=7,F(n,s,o);case 7:u=t.sent,t.next=14;break;case 10:t.prev=10,t.t0=t.catch(4),alert("Check your internet connection, or open a VPN :)"),console.error(t.t0);case 14:if(void 0===u){t.next=24;break}if(!u){t.next=22;break}return t.next=18,B("Correct!","yellowgreen",950);case 18:D(n),e.updateCharacters(n),t.next=24;break;case 22:return t.next=24,B("Incorrect!","red",950);case 24:case"end":return t.stop()}}),t,null,[[4,10]])})))).apply(this,arguments)}function D(e){return T.apply(this,arguments)}function T(){return(T=Object(l.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x((function(e){var n=Object(p.a)(e);return n.indexOf(t)>-1&&n.splice(n.indexOf(t),1),n}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,n){return M.apply(this,arguments)}function M(){return(M=Object(l.a)(d.a.mark((function e(n,a,r){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=!1,e.next=3,t.get().then((function(e){var t=!1;if(e.exists){var i=e.data();if(i&&i[n]){t=!0;var s=i[n];a>=s.startX&&a<=s.endX&&r>=s.startY&&r<=s.endY&&(c=!0)}}t||console.error("characters data not found")}));case 3:return e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e,t,n){return N.apply(this,arguments)}function N(){return(N=Object(l.a)(d.a.mark((function e(t,n,a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y(Object(j.jsx)("div",{id:"notification",style:{backgroundColor:n,opacity:0},children:t})),setTimeout((function(){y(Object(j.jsx)("div",{id:"notification",style:{backgroundColor:n,opacity:1},children:t}))})),a>-1&&(setTimeout((function(){y(Object(j.jsx)("div",{id:"notification",style:{backgroundColor:n,opacity:0},children:t}))}),a),setTimeout((function(){y(Object(j.jsx)(j.Fragment,{}))}),a+10));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){i?setTimeout((function(){y(Object(j.jsx)(j.Fragment,{}))})):B("Loading...","#ffc802",-1)}),[i]),Object(r.useEffect)((function(){0===b.length&&e.gameOver()}),[JSON.stringify(b)]),Object(j.jsxs)("div",{id:"Game",children:[g,S,Object(j.jsx)("img",{style:{opacity:0},onLoad:function(t){s(!0),y(Object(j.jsx)(j.Fragment,{})),O||setTimeout((function(){B("Find the characters who are displayed in the header in the shortest time possible.","#0a7afa",5e3)}),100),t.target.style.opacity="1",e.imageIsLoaded()},src:"assets/building.jpg",id:"game-image",onClick:function(e){!function(e,t){C(Object(j.jsx)(j.Fragment,{})),setTimeout((function(){C(Object(j.jsx)(h,{choices:b,x:e,y:t,onClick:I}))}))}(e.pageX,e.pageY)},alt:"building"})]})},m=(n(34),new Map);m.set("Easy",["Kaonashi","Bowser","Packman"]),m.set("Medium",["Kaiman","Guts","Godzilla"]),m.set("Hard",["Jerry","Corvo Attano","Saitama"]);var v=function(e){return Object(j.jsx)("div",{id:"levels-container",children:Object(j.jsxs)("div",{id:"SelectLevel",onClick:function(t){t.target.id.includes("select")&&e.onClick(t.target.textContent,m.get(t.target.textContent))},children:[Object(j.jsx)("div",{id:"select-easy",children:"Easy"}),Object(j.jsx)("div",{id:"select-medium",children:"Medium"}),Object(j.jsx)("div",{id:"select-hard",children:"Hard"})]})})};n(35);var g=function(e){var t=Object(r.useState)([]),n=Object(f.a)(t,2),a=n[0],c=n[1];function i(e,t){if(0!==Object.keys(t).length){var n=[],a=[];for(var r in t)n.push(Object.assign({name:r},t[r]));n.sort((function(e,t){return e.duration-t.duration}));var i=1;n.map((function(e){return Object.assign(e,{rank:i++})})),n.forEach((function(t){a.push(Object(j.jsxs)("tr",{id:"ID"+t.ID,children:[Object(j.jsx)("td",{children:t.rank}),Object(j.jsx)("td",{children:t.name}),Object(j.jsx)("td",{children:k(t.duration/1e3)}),Object(j.jsx)("td",{children:new Date(t.recordedAt).toUTCString()})]},t.name+e)),c(a)}))}else c([])}return Object(r.useEffect)((function(){var t;null===(t=document.querySelector("#"+e.showTable+"-table"))||void 0===t||t.classList.add("active-table");var n=e.showTable||"Easy";e.data?i(n,e.data[n]):c([Object(j.jsx)("div",{children:"Loading..."},"loading"+Math.random())])}),[e.at,e.data,e.showTable]),Object(r.useEffect)((function(){var t=document.querySelector(e.at);t&&(t.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),t.setAttribute("style","background-color:#0874FA;color:black;"))}),[JSON.stringify(a)]),Object(j.jsxs)("div",{id:"Leaderboard",children:[Object(j.jsxs)("nav",{onClick:function(t){var n=t.target,a=document.querySelector(".active-table");a&&a.classList.remove("active-table"),n.classList.add("active-table"),i(n.textContent||"Easy",e.data[n.textContent||"Easy"])},children:[Object(j.jsx)("div",{id:"Easy-table",children:"Easy"}),Object(j.jsx)("div",{id:"Medium-table",children:"Medium"}),Object(j.jsx)("div",{id:"Hard-table",children:"Hard"})]}),Object(j.jsx)("table",{children:Object(j.jsxs)("tbody",{children:[Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{children:"rank"}),Object(j.jsx)("th",{children:"Name"}),Object(j.jsx)("th",{children:"Record"}),Object(j.jsx)("th",{children:"Date"})]}),a]})})]})},y=n(22),w=n.n(y);function k(e){var t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),a=e-3600*t-60*n;return t<10&&0!==t?t="0"+t+":":0===t&&(t=""),n<10&&(n="0"+n),(a=Math.round(100*a)/100)<10&&(a="0"+a),t+""+n+":"+a}var S=function(){var e=Object(r.useState)(!1),t=Object(f.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)(!1),s=Object(f.a)(i,2),u=s[0],p=s[1],h=Object(r.useState)(w()()),O=Object(f.a)(h,2),m=O[0],y=(O[1],Object(r.useState)(Object(j.jsx)(v,{onClick:function(e,t){J(e),C(Object(j.jsx)(x,{imageIsLoaded:U,characters:t,updateCharacters:Q,gameOver:W})),B(t)}}))),k=Object(f.a)(y,2),S=k[0],C=k[1],E=Object(r.useState)(Object(j.jsx)(j.Fragment,{})),I=Object(f.a)(E,2),L=I[0],D=I[1],T=Object(r.useState)(["empty"]),F=Object(f.a)(T,2),M=F[0],B=F[1],N=Object(r.useState)("non-selected"),A=Object(f.a)(N,2),q=A[0],J=A[1],Y=Object(r.useState)(""),z=Object(f.a)(Y,2),H=z[0],G=z[1],P=a.a.firestore().collection("sessions"),R=P.doc(m),K=a.a.firestore().collection("leaderboard");function X(){return(X=Object(l.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:R.set({addedIn:Date.now(),gameStartedIn:null,gameEndedIn:null,difficulty:null});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){return V.apply(this,arguments)}function V(){return(V=Object(l.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c(!0),R.update({gameStartedIn:Date.now()});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return Z.apply(this,arguments)}function Z(){return(Z=Object(l.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.next=3,R.update({gameEndedIn:Date.now()});case 3:oe();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return(_=Object(l.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:P.get().then((function(e){e.forEach((function(e){var n=e.data();Date.now()-n.addedIn>=60*t*60*1e3&&e.ref.delete()}))}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e){return $.apply(this,arguments)}function $(){return($=Object(l.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:G(t);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(e,t){return te.apply(this,arguments)}function te(){return(te=Object(l.a)(d.a.mark((function e(t,n){var a,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return a=t.gameEndedIn-t.gameStartedIn,r=t.gameEndedIn,c=t.difficulty,e.next=6,K.doc(c).update(Object(o.a)({},n,{duration:a,recordedAt:r,ID:m}));case 6:e.next=9;break;case 8:alert("couldn't record result to leaderboard");case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(e){return ae.apply(this,arguments)}function ae(){return(ae=Object(l.a)(d.a.mark((function e(t){var n,a,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=(r=null===(n=t.target)||void 0===n?void 0:n.querySelector("#name-input").value).trim(),(c=null===(a=t.target)||void 0===a?void 0:a.querySelector("#submit-button")).disabled=!0,!t.target){e.next=8;break}return e.next=8,R.get().then(function(){var e=Object(l.a)(d.a.mark((function e(t){var n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.exists){e.next=14;break}return e.next=3,re(r,null===(n=t.data())||void 0===n?void 0:n.difficulty);case 3:if(e.sent){e.next=12;break}return D(Object(j.jsx)(j.Fragment,{})),C(Object(j.jsx)(g,{})),e.next=9,ee(t.data(),r);case 9:ie(null===(a=t.data())||void 0===a?void 0:a.difficulty,r),e.next=14;break;case 12:c.disabled=!1,alert("This name is used already.");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e,t){return ce.apply(this,arguments)}function ce(){return(ce=Object(l.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!1,e.next=3,K.doc(n).get().then((function(e){e.exists&&(e.data()||{})[t]&&(a=!0)}));case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e,t){return se.apply(this,arguments)}function se(){return(se=Object(l.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},e.next=3,K.get().then((function(e){e.forEach((function(e){e.exists&&(a[e.id]=e.data())}))}));case 3:C(Object(j.jsx)(g,{data:a,showTable:t,at:"#ID"+m}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(){D(Object(j.jsxs)("form",{style:{opacity:0},children:[Object(j.jsxs)("div",{id:"name-input-container",children:[Object(j.jsx)("label",{children:"Your name:"}),Object(j.jsx)("input",{id:"name-input"})]}),Object(j.jsx)("input",{id:"submit-button",type:"submit"})]})),setTimeout((function(){D(Object(j.jsxs)("form",{onSubmit:ne,style:{opacity:1},children:[Object(j.jsxs)("div",{id:"name-input-container",children:[Object(j.jsx)("label",{children:"Your name:"}),Object(j.jsx)("input",{id:"name-input",required:!0})]}),Object(j.jsx)("input",{id:"submit-button",type:"submit"})]}))}),200)}return Object(r.useEffect)((function(){!function(){X.apply(this,arguments)}(),function(e){_.apply(this,arguments)}(4)}),[]),Object(r.useEffect)((function(){R.update({difficulty:q})}),[q]),Object(j.jsxs)("div",{className:"App",children:[Object(j.jsx)(b,{foundCharacter:H,gameStarted:n,characters:M,gameEnded:u,showLeaderBoard:function(){C(Object(j.jsx)(g,{})),ie("Easy",""),p(!0)}}),L,S]})},C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))},E=a.a.initializeApp({apiKey:"AIzaSyCfUgLy7_SmD78BLzr7ohztt7o9tZyj6IM",authDomain:"where-s-waldo-7ace2.firebaseapp.com",projectId:"where-s-waldo-7ace2",storageBucket:"where-s-waldo-7ace2.appspot.com",messagingSenderId:"225583877908",appId:"1:225583877908:web:4f36fc2d5a8567e7473c01",measurementId:"G-RW1YB0F875"});s.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(S,{})}),document.getElementById("root")),C()}},[[36,1,2]]]);
//# sourceMappingURL=main.bbee9aec.chunk.js.map